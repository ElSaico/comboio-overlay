<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
	<link rel="stylesheet" href="../node_modules/jsonform/deps/opt/bootstrap.css"></script>
	<script type="text/javascript" src="../node_modules/jsonform/deps/jquery.min.js"></script>
	<script type="text/javascript" src="../node_modules/jsonform/deps/opt/jquery-ui.js"></script>
	<script type="text/javascript" src="../node_modules/jsonform/deps/underscore.js"></script>
	<script type="text/javascript" src="../node_modules/jsonform/lib/jsonform.js"></script>
</head>
<body>
  <div class="container">
    <h2>Counters</h2>
	  <form id="counters"></form>
  </div>
	<script type="text/javascript">
    const counters = nodecg.Replicant('counters');
    counters.on('change', value => {
      $('#counters').empty().jsonForm({
        schema: {
          counters: {
            type: "array",
            items: {
              type: "object",
              properties: {
                command: { type: "string", title: "Command", required: true },
                message: { type: "string", title: "Message", description: "Use #### to replace with count" },
                count: { type: "integer", title: "Count", default: 0 },
                show: { type: "boolean", title: "Show on screen", required: true }
              }
            }
          }
        },
        form: [
          {
            key: "counters",
            notitle: true,
            items: {
              type: "section",
              items: [
                { key: "counters[].command", prepend: "!" },
                "counters[].message",
                "counters[].count",
                "counters[].show"
              ]
            }
          },
          {
            type: "submit",
            title: "Update"
          }
        ],
        value: { counters: value },
        onSubmitValid: values => {
          counters.value = values.counters;
        }
      });
    });
	</script>
</body>
</html>
